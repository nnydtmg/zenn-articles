---
title: 【AWS】Windows10にAWS-CLI ver.2をインストールしてみた
tags:
  - AWS
  - aws-cli
  - Windows10
  - 構築
private: false
updated_at: '2020-11-26T23:02:40+09:00'
id: 359bdf709cde790b79a9
organization_url_name: null
slide: false
ignorePublish: false
---
#はじめに
AWSを勉強するために、ノートPCにAWS-CLIをインストールしてみたので、備忘として残しておきます。

###PCスペック
* OS：Windows 10 Home(バージョン　20H2(OSビルド　19042.630))
* CPU：Intel Core i7-10510U 1.80GHz(2.30GHz)
* RAM：16.0GB

#目次
1. インストール
2. 設定

#1. インストール
基本的には以下の公式サイトの通りインストールを進めればOKです。
[Windows での AWS CLI バージョン 2 のインストール、更新、アンインストール](https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/install-cliv2-windows.html)

##前提条件
インストールする前に事前に以下の確認が必要です。
* 64ビットバージョンのWindows XP以降のOS
* ソフトウェアインストール用の管理者権限

##MSIインストーラをダウンロードする
最新版のインストーラをダウンロードします。
※特定のバージョンが欲しい場合はバージョンを指定してください。(公式サイトのリンクを参照してください。)
[CLIv2(最新版)のインストーラ](https://awscli.amazonaws.com/AWSCLIV2.msi)

##インストールする
ダウンロードしたMSIインストールを実行し、ウィザードに沿ってインストールを進めます。
インストールが完了したら、スタートメニューからコマンドプロンプト(cmd)を開き、以下のコマンドを入力して確認します。

```
aws --version
```
>aws-cli/2.1.4 Python/3.7.9 Windows/10 exe/AMD64

のように出力されればOKです。

インストールはこれだけです。
非常に簡単にインストールが出来ました。


#2. 設定
インストールが完了したら、AWSに接続できるように諸々の設定を行います。
ここからは実際にコンソール画面から必要情報を取得したり、それをCLIのconfigに設定していきます。

##アクセスキー/シークレットキーの取得
AWSコンソール画面から、IAMを検索しIAMサービスページに遷移してください。

IAMページから「アクセス管理」＞「ユーザー」を選択してください。

任意の(CLIで利用したい)ユーザーを選択し、タブから「認証情報」を選択してください。

「アクセスキー」の欄にある、「アクセスキーの作成」ボタンを押します。
※アクセスキーとシークレットキーは絶対に外部に出ないように注意してください。

アクセスキー/シークレットキーがcsvファイルでダウンロードされます。
これを用いてCLIに設定をしていきます。

##CLIの設定
スタートメニューから「cmd」を起動し、以下のコマンドを入力してください。

```
C:\> aws configure
AWS Access Key ID [None]:取得したアクセスキーを入力
AWS Secret Access Key [None]:取得したシークレットキーを入力
Default region name [None]:デフォルトで使用するリージョンを入力(東京の場合は、ap-northeast-1)
Default output format [None]:出力フォーマットを入力(json,yaml,yaml-stream,text,tableのいずれかを入力(今回はjsonを指定)。変更も可能)
```
出力フォーマットの説明は以下の通りです。(2020/11/26時点)
実行コマンドに\--outputオプションを指定すれば、コマンド実行時に変更もできます。

|形式|説明|
|:---|:---|
|json|JSON 文字列形式で出力されます。|
|yaml|YAML 文字列形式で出力されます。（AWS CLI バージョン 2 でのみ利用できます。）|
|yaml-stream|出力はストリーミングされ、YAML 文字列としてフォーマットされます。ストリーミングにより、大きなデータ型の処理を高速化できます。（AWS CLI バージョン 2 でのみ利用できます。）|
|text|複数行のタブ区切り文字列値の形式で出力されます。これは、grep、sed、または awk などのテキストプロセッサに出力を渡すのに役立ちます。|
|table|セルの罫線を形成する文字列 +&#124;	- を使用して表形式で出力されます。通常、情報は他の形式よりも読みやすい「わかりやすい」形式で表示されますが、プログラムとしては役立ちません。|


##接続確認
cmdにて接続できるか確認してみます。
今回は、IAMユーザーの一覧を表示するコマンドを実行します。

```
C:\>aws iam list-users
{
  "Users":[
       {
         ...ここに作成済みのユーザが表示されます。
       }
   ]
}
```
と出力されれば完了です。

S3バケットの確認コマンドも念のため実行しておきます。

```
C:\>aws s3 ls
```
作成済みのS3バケットが表示されれば完了です。


##プロファイル設定
CLIではプロファイルと呼ばれる設定のコレクションがあります。
デフォルトでは「default」プロファイルを使用しますが、実行コマンドに\--profileオプションを指定すれば、作成済の各プロファイルにて実行が可能になります。

###プロファイル作成
基本的に先ほどの設定手順と同じです。
今回は「devuser」というプロファイルを作成してみます。
出力フォーマットを変更してもらえると、差がわかりやすいかと思います。(json⇒textに変更しました。)

```
C:\> aws configure --profile devuser
AWS Access Key ID [None]:取得したアクセスキーを入力
AWS Secret Access Key [None]:取得したシークレットキーを入力
Default region name [None]:デフォルトで使用するリージョンを入力(東京の場合は、ap-northeast-1)
Default output format [None]:出力フォーマットを入力(json,yaml,yaml-stream,text,tableのいずれかを入力。変更も可能)
```
設定を確認してみます。

```
C:\>aws iam list-users --profile devuser
USERS arn:...
```
先ほどと表示されるフォーマットが変わっていれば完了です。

#さいごに
今回は、Win10端末にAWS CLI2をインストールし、接続確認までを行いました。
今後CLIを用いた構築などを更新していければと思います。
また、CLIについてのユーザーガイドは以下をご確認ください。
[AWS コマンドラインインターフェイスのドキュメント](https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/cli-chap-welcome.html)

